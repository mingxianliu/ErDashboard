<!DOCTYPE html>
<html>
<head>
    <title>Debug Test - Dashboard Issues</title>
</head>
<body>
    <h1>Debug Test</h1>

    <h2>1. 检查 localStorage 中的待测试数据</h2>
    <button onclick="checkPendingTests()">检查 pending-tests</button>
    <div id="pending-result"></div>

    <h2>2. 检查项目成员数据</h2>
    <button onclick="checkTeamData()">检查团队数据</button>
    <div id="team-result"></div>

    <h2>3. 测试徽章显示</h2>
    <button onclick="testBadge()">测试 ErCore 徽章</button>
    <span class="badge bg-warning text-dark me-2"
          id="project-test-ErCore"
          style="display: none;"
          title="有新推送，待测试">
        ⚠️ 待测试
    </span>

    <script>
    function checkPendingTests() {
        const pendingTests = localStorage.getItem('pending-tests');
        document.getElementById('pending-result').innerHTML =
            '<pre>' + JSON.stringify(JSON.parse(pendingTests || '{}'), null, 2) + '</pre>';
    }

    function checkTeamData() {
        // 试图访问主页面的团队数据
        if (window.opener && window.opener.globalTeamDataManager) {
            const teamData = window.opener.globalTeamDataManager.getAllProjects();
            document.getElementById('team-result').innerHTML =
                '<pre>' + JSON.stringify(teamData, null, 2) + '</pre>';
        } else {
            document.getElementById('team-result').innerHTML =
                '无法访问主页面数据，请在主页面中打开此页面';
        }
    }

    function testBadge() {
        const badge = document.getElementById('project-test-ErCore');
        if (badge.style.display === 'none') {
            badge.style.display = 'inline-block';
            console.log('显示徽章');
        } else {
            badge.style.display = 'none';
            console.log('隐藏徽章');
        }
    }

    // 自动检查
    setTimeout(() => {
        checkPendingTests();
        checkTeamData();
    }, 1000);
    </script>
</body>
</html>