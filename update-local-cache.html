<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>更新本地快取</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; padding: 20px; }
        .button { padding: 10px 20px; margin: 10px; cursor: pointer; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>更新本地快取</h1>
    <p>這個工具會清除舊的快取並強制重新載入最新的 team-members.json</p>
    
    <button class="button" onclick="updateCache()">立即更新快取</button>
    <button class="button" onclick="clearAllCache()">清除所有快取</button>
    
    <div id="result"></div>

    <script>
        async function updateCache() {
            const resultDiv = document.getElementById('result');
            try {
                // 清除舊的快取
                localStorage.removeItem('cachedTeamMembers');
                localStorage.removeItem('teamMemberChanges');
                
                // 載入最新的資料
                const response = await fetch('config/team-members.json?v=' + Date.now());
                const data = await response.json();
                
                // 儲存到快取
                localStorage.setItem('cachedTeamMembers', JSON.stringify(data));
                
                resultDiv.innerHTML = `
                    <p class="success">✅ 快取已更新！</p>
                    <p>載入了 ${Object.keys(data.members).length} 個成員</p>
                    <p>包含更新：</p>
                    <ul>
                        <li>A-CA: ${data.members['A-CA'].name}</li>
                        <li>B-CA: ${data.members['B-CA'].name}</li>
                        <li>C-CA: ${data.members['C-CA'].name}</li>
                    </ul>
                    <p><strong>請重新整理主頁面以查看更新</strong></p>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<p class="error">❌ 更新失敗: ${error.message}</p>`;
            }
        }
        
        function clearAllCache() {
            localStorage.clear();
            sessionStorage.clear();
            document.getElementById('result').innerHTML = '<p class="success">✅ 所有快取已清除！請重新整理主頁面。</p>';
        }
        
        // 自動更新
        updateCache();
    </script>
</body>
</html>
