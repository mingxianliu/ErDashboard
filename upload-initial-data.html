<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸Šå‚³åˆå§‹å°ˆæ¡ˆè³‡æ–™åˆ° Google Drive</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
        .result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .error { background: #f8d7da; color: #721c24; }
        .success { background: #d4edda; color: #155724; }
        .info { background: #d1ecf1; color: #0c5460; }
        .warning { background: #fff3cd; color: #856404; }
        button { padding: 10px 20px; margin: 10px 5px; font-size: 16px; cursor: pointer; }
        .project-card { border: 1px solid #ddd; margin: 10px 0; padding: 15px; border-radius: 8px; }
    </style>
</head>
<body>
    <h1>ğŸ“¤ ä¸Šå‚³åˆå§‹å°ˆæ¡ˆè³‡æ–™åˆ° Google Drive</h1>
    <div id="status">æº–å‚™ä¸­...</div>

    <div id="buttons" style="display: none;">
        <button onclick="uploadAllProjectData()">ğŸš€ ä¸Šå‚³æ‰€æœ‰å°ˆæ¡ˆè³‡æ–™</button>
        <button onclick="uploadCurrentTeamConfig()">ğŸ‘¥ ä¸Šå‚³ç›®å‰åœ˜éšŠè¨­å®š</button>
    </div>

    <div id="project-preview">
        <h2>ğŸ“‹ å³å°‡ä¸Šå‚³çš„å°ˆæ¡ˆè³‡æ–™é è¦½</h2>
        <div id="projects-list"></div>
    </div>

    <div id="results"></div>

    <script src="https://apis.google.com/js/api.js"></script>
    <script src="https://accounts.google.com/gsi/client"></script>
    <script>
        const CLIENT_ID = 'YOUR_CLIENT_ID_HERE.apps.googleusercontent.com'; // è«‹æ›¿æ›ç‚ºæ‚¨çš„ Client ID
        const SCOPES = 'https://www.googleapis.com/auth/drive.file';
        const FOLDER_ID = 'YOUR_FOLDER_ID_HERE'; // è«‹æ›¿æ›ç‚ºæ‚¨çš„è³‡æ–™å¤¾ ID

        let tokenClient;
        let accessToken = null;

        // å°ˆæ¡ˆåŸºæœ¬è³‡æ–™
        const projectsData = {
            ErCore: {
                projectId: "ErCore",
                projectName: "ErCore - ä¼æ¥­ç´š AI çµ±ä¸€å¹³å°",
                description: "ä¼æ¥­ç´šäººå·¥æ™ºæ…§çµ±ä¸€ç®¡ç†å¹³å°ï¼Œæ•´åˆå¤šç¨® AI æœå‹™ä¸¦æä¾›çµ±ä¸€ä»‹é¢",
                status: "active",
                priority: "high",
                startDate: "2025-01-15",
                estimatedEndDate: "2025-06-30",
                budget: "é«˜é ç®—å°ˆæ¡ˆ",
                technologies: ["AI/ML", "Python", "React", "Docker", "Kubernetes"],
                goals: [
                    "å»ºç«‹ä¼æ¥­ç´š AI æœå‹™æ•´åˆå¹³å°",
                    "æä¾›çµ±ä¸€çš„ AI API ä»‹é¢",
                    "å¯¦ç¾å¤šæ¨¡å‹éƒ¨ç½²å’Œç®¡ç†",
                    "å»ºç«‹ç›£æ§å’Œåˆ†æç³»çµ±"
                ],
                milestones: [
                    { name: "éœ€æ±‚åˆ†æå®Œæˆ", date: "2025-02-01", status: "completed" },
                    { name: "æ¶æ§‹è¨­è¨ˆå®Œæˆ", date: "2025-02-15", status: "in_progress" },
                    { name: "æ ¸å¿ƒåŠŸèƒ½é–‹ç™¼", date: "2025-04-01", status: "pending" },
                    { name: "æ¸¬è©¦å’Œéƒ¨ç½²", date: "2025-05-15", status: "pending" },
                    { name: "æ­£å¼ä¸Šç·š", date: "2025-06-30", status: "pending" }
                ],
                team: {
                    "A-CC": { role: "frontend", tasks: ["UI è¨­è¨ˆ", "å‰ç«¯æ¶æ§‹", "çµ„ä»¶é–‹ç™¼"] },
                    "B-CC": { role: "backend", tasks: ["API é–‹ç™¼", "è³‡æ–™åº«è¨­è¨ˆ", "æœå‹™æ¶æ§‹"] },
                    "C-CC": { role: "testing", tasks: ["åŠŸèƒ½æ¸¬è©¦", "æ•ˆèƒ½æ¸¬è©¦", "å“è³ªä¿è­‰"] }
                },
                risks: [
                    "AI æ¨¡å‹æ•´åˆè¤‡é›œåº¦é«˜",
                    "æ•ˆèƒ½è¦æ±‚åš´æ ¼",
                    "å®‰å…¨æ€§è¦æ±‚é«˜"
                ]
            },

            ErNexus: {
                projectId: "ErNexus",
                projectName: "ErNexus - ä¼æ¥­ç´šçµ±ä¸€å¹³å°",
                description: "ä¼æ¥­ç´šçµ±ä¸€ç®¡ç†å¹³å°ï¼Œæ•´åˆå„ç¨®ä¼æ¥­æœå‹™å’Œå·¥å…·",
                status: "completed",
                priority: "medium",
                startDate: "2025-02-01",
                estimatedEndDate: "2025-04-30",
                actualEndDate: "2025-04-25",
                budget: "ä¸­ç­‰é ç®—å°ˆæ¡ˆ",
                technologies: ["React", "Node.js", "PostgreSQL", "Redis", "JWT"],
                goals: [
                    "å»ºç«‹ä¼æ¥­çµ±ä¸€ç®¡ç†ä»‹é¢",
                    "æ•´åˆç¾æœ‰ä¼æ¥­ç³»çµ±",
                    "æä¾›å–®ä¸€ç™»å…¥åŠŸèƒ½",
                    "å»ºç«‹æ¬Šé™ç®¡ç†ç³»çµ±"
                ],
                milestones: [
                    { name: "éœ€æ±‚åˆ†æå®Œæˆ", date: "2025-02-10", status: "completed" },
                    { name: "ç³»çµ±è¨­è¨ˆå®Œæˆ", date: "2025-02-20", status: "completed" },
                    { name: "æ ¸å¿ƒé–‹ç™¼å®Œæˆ", date: "2025-03-20", status: "completed" },
                    { name: "æ•´åˆæ¸¬è©¦å®Œæˆ", date: "2025-04-10", status: "completed" },
                    { name: "å°ˆæ¡ˆäº¤ä»˜", date: "2025-04-25", status: "completed" }
                ],
                team: {
                    "A-CA": { role: "frontend", tasks: ["Admin Portal UI", "React çµ„ä»¶", "ç‹€æ…‹ç®¡ç†"] },
                    "B-CA": { role: "backend", tasks: ["å¾®æœå‹™æ¶æ§‹", "JWT èªè­‰", "API æ•´åˆ"] },
                    "C-CA": { role: "testing", tasks: ["æ•´åˆæ¸¬è©¦", "API æ¸¬è©¦", "è‡ªå‹•åŒ–æ¸¬è©¦"] }
                },
                achievements: [
                    "æˆåŠŸæ•´åˆ 5 å€‹ä¼æ¥­ç³»çµ±",
                    "å¯¦ç¾å–®ä¸€ç™»å…¥åŠŸèƒ½",
                    "å»ºç«‹å®Œæ•´çš„æ¬Šé™ç®¡ç†é«”ç³»",
                    "ç²å¾—ç”¨æˆ¶é«˜åº¦æ»¿æ„åº¦"
                ]
            },

            ErShield: {
                projectId: "ErShield",
                projectName: "ErShield - å®‰å…¨é˜²è­·å¹³å°",
                description: "ä¼æ¥­ç´šå®‰å…¨é˜²è­·å’Œç›£æ§å¹³å°ï¼Œæä¾›å…¨æ–¹ä½çš„å®‰å…¨ä¿è­·",
                status: "active",
                priority: "high",
                startDate: "2025-03-01",
                estimatedEndDate: "2025-08-31",
                budget: "é«˜é ç®—å°ˆæ¡ˆ",
                technologies: ["Cybersecurity", "Python", "Go", "Docker", "ELK Stack"],
                goals: [
                    "å»ºç«‹ä¼æ¥­å®‰å…¨ç›£æ§ä¸­å¿ƒ",
                    "å¯¦ç¾å¨è„…æª¢æ¸¬å’Œé è­¦",
                    "æä¾›å®‰å…¨äº‹ä»¶éŸ¿æ‡‰æ©Ÿåˆ¶",
                    "å»ºç«‹åˆè¦å ±å‘Šç³»çµ±"
                ],
                milestones: [
                    { name: "å®‰å…¨éœ€æ±‚åˆ†æ", date: "2025-03-15", status: "completed" },
                    { name: "å¨è„…æ¨¡å‹å»ºç«‹", date: "2025-04-01", status: "in_progress" },
                    { name: "æ ¸å¿ƒé˜²è­·åŠŸèƒ½", date: "2025-05-15", status: "pending" },
                    { name: "ç›£æ§ç³»çµ±é–‹ç™¼", date: "2025-07-01", status: "pending" },
                    { name: "ç³»çµ±ä¸Šç·šæ¸¬è©¦", date: "2025-08-31", status: "pending" }
                ],
                team: {
                    "A-GI": { role: "frontend", tasks: ["å®‰å…¨å„€è¡¨æ¿", "Docker é¢¨æ ¼è¨­è¨ˆ", "éŸ¿æ‡‰å¼å¸ƒå±€"] },
                    "B-GI": { role: "backend", tasks: ["å®‰å…¨æ¨¡çµ„", "æ¬Šé™ç®¡ç†", "æ—¥èªŒç³»çµ±"] },
                    "C-GI": { role: "testing", tasks: ["å®‰å…¨æ¸¬è©¦", "æ»²é€æ¸¬è©¦", "åˆè¦é©—è­‰"] }
                },
                securityFeatures: [
                    "å¯¦æ™‚å¨è„…æª¢æ¸¬",
                    "å…¥ä¾µé˜²è­·ç³»çµ±",
                    "æ•¸æ“šåŠ å¯†ä¿è­·",
                    "å­˜å–æ§åˆ¶ç®¡ç†",
                    "å¯©è¨ˆæ—¥èªŒè¨˜éŒ„"
                ]
            },

            ErTidy: {
                projectId: "ErTidy",
                projectName: "ErTidy - ä¼æ¥­ç´šæ™ºèƒ½é–‹ç™¼å¹³å°",
                description: "æ™ºèƒ½åŒ–é–‹ç™¼å¹³å°ï¼Œæä¾› AI è¼”åŠ©çš„ä»£ç¢¼é–‹ç™¼å’Œç®¡ç†å·¥å…·",
                status: "active",
                priority: "medium",
                startDate: "2025-04-01",
                estimatedEndDate: "2025-10-31",
                budget: "ä¸­é«˜é ç®—å°ˆæ¡ˆ",
                technologies: ["AI/ML", "Rust", "TypeScript", "WebAssembly", "TensorFlow"],
                goals: [
                    "å»ºç«‹ AI è¼”åŠ©é–‹ç™¼ç’°å¢ƒ",
                    "æä¾›æ™ºèƒ½ä»£ç¢¼ç”Ÿæˆ",
                    "å¯¦ç¾è‡ªå‹•åŒ–æ¸¬è©¦é©…å‹•é–‹ç™¼",
                    "å»ºç«‹ä»£ç¢¼å“è³ªç›£æ§ç³»çµ±"
                ],
                milestones: [
                    { name: "AI æ¨¡å‹è¨“ç·´", date: "2025-04-20", status: "in_progress" },
                    { name: "é–‹ç™¼å·¥å…·æ•´åˆ", date: "2025-06-01", status: "pending" },
                    { name: "æ™ºèƒ½åŠŸèƒ½é–‹ç™¼", date: "2025-08-01", status: "pending" },
                    { name: "å“è³ªç³»çµ±å»ºç«‹", date: "2025-09-15", status: "pending" },
                    { name: "å¹³å°æ­£å¼ç™¼å¸ƒ", date: "2025-10-31", status: "pending" }
                ],
                team: {
                    "A-CI": { role: "frontend", tasks: ["æ™ºèƒ½ IDE", "è¨­è¨ˆç³»çµ±", "é–‹ç™¼å·¥å…· UI"] },
                    "B-CI": { role: "backend", tasks: ["AI å¼•æ“", "Rust æ ¸å¿ƒ", "æ™ºèƒ½åˆ†æ"] },
                    "C-CI": { role: "testing", tasks: ["AI-TDD æ¸¬è©¦", "æ™ºèƒ½æ¸¬è©¦", "ä»£ç¢¼å“è³ª"] }
                },
                aiFeatures: [
                    "æ™ºèƒ½ä»£ç¢¼è£œå…¨",
                    "è‡ªå‹•åŒ–é‡æ§‹å»ºè­°",
                    "æ™ºèƒ½æ¸¬è©¦ç”Ÿæˆ",
                    "ä»£ç¢¼å“è³ªåˆ†æ",
                    "æ•ˆèƒ½å„ªåŒ–å»ºè­°"
                ]
            }
        };

        // åœ˜éšŠé…ç½®è³‡æ–™
        const teamConfig = {
            members: {
                "A-CC": { "id": "A-CC", "name": "æˆå“¡A-CC", "skills": ["frontend", "backend", "testing"], "primaryRole": "fullstack", "avatar": "A-CC", "joinDate": "2025-01-01", "notes": "è² è²¬ ErCore å‰ç«¯é–‹ç™¼" },
                "A-CA": { "id": "A-CA", "name": "æˆå“¡A-CA", "skills": ["frontend", "backend", "testing"], "primaryRole": "fullstack", "avatar": "A-CA", "joinDate": "2025-01-01", "notes": "è² è²¬ ErNexus å‰ç«¯é–‹ç™¼" },
                "A-GI": { "id": "A-GI", "name": "æˆå“¡A-GI", "skills": ["frontend", "backend", "testing"], "primaryRole": "fullstack", "avatar": "A-GI", "joinDate": "2025-01-01", "notes": "è² è²¬ ErShield å‰ç«¯é–‹ç™¼" },
                "A-CI": { "id": "A-CI", "name": "æˆå“¡A-CI", "skills": ["frontend", "backend", "testing"], "primaryRole": "fullstack", "avatar": "A-CI", "joinDate": "2025-01-01", "notes": "è² è²¬ ErTidy å‰ç«¯é–‹ç™¼" },
                "A-CS": { "id": "A-CS", "name": "æˆå“¡A-CS", "skills": ["frontend", "backend", "testing"], "primaryRole": "fullstack", "avatar": "A-CS", "joinDate": "2025-01-01", "notes": "å‚™ç”¨æˆå“¡" },
                "A-VC": { "id": "A-VC", "name": "æˆå“¡A-VC", "skills": ["frontend", "backend", "testing"], "primaryRole": "fullstack", "avatar": "A-VC", "joinDate": "2025-01-01", "notes": "å‚™ç”¨æˆå“¡" },
                "B-CC": { "id": "B-CC", "name": "æˆå“¡B-CC", "skills": ["frontend", "backend", "testing"], "primaryRole": "fullstack", "avatar": "B-CC", "joinDate": "2025-01-01", "notes": "è² è²¬ ErCore å¾Œç«¯é–‹ç™¼" },
                "B-CA": { "id": "B-CA", "name": "æˆå“¡B-CA", "skills": ["frontend", "backend", "testing"], "primaryRole": "fullstack", "avatar": "B-CA", "joinDate": "2025-01-01", "notes": "è² è²¬ ErNexus å¾Œç«¯é–‹ç™¼" },
                "B-GI": { "id": "B-GI", "name": "æˆå“¡B-GI", "skills": ["frontend", "backend", "testing"], "primaryRole": "fullstack", "avatar": "B-GI", "joinDate": "2025-01-01", "notes": "è² è²¬ ErShield å¾Œç«¯é–‹ç™¼" },
                "B-CI": { "id": "B-CI", "name": "æˆå“¡B-CI", "skills": ["frontend", "backend", "testing"], "primaryRole": "fullstack", "avatar": "B-CI", "joinDate": "2025-01-01", "notes": "è² è²¬ ErTidy å¾Œç«¯é–‹ç™¼" },
                "B-CS": { "id": "B-CS", "name": "æˆå“¡B-CS", "skills": ["frontend", "backend", "testing"], "primaryRole": "fullstack", "avatar": "B-CS", "joinDate": "2025-01-01", "notes": "å‚™ç”¨æˆå“¡" },
                "B-VC": { "id": "B-VC", "name": "æˆå“¡B-VC", "skills": ["frontend", "backend", "testing"], "primaryRole": "fullstack", "avatar": "B-VC", "joinDate": "2025-01-01", "notes": "å‚™ç”¨æˆå“¡" },
                "C-CC": { "id": "C-CC", "name": "æˆå“¡C-CC", "skills": ["frontend", "backend", "testing"], "primaryRole": "fullstack", "avatar": "C-CC", "joinDate": "2025-01-01", "notes": "è² è²¬ ErCore é©—æ¸¬éƒ¨ç½²" },
                "C-CA": { "id": "C-CA", "name": "æˆå“¡C-CA", "skills": ["frontend", "backend", "testing"], "primaryRole": "fullstack", "avatar": "C-CA", "joinDate": "2025-01-01", "notes": "è² è²¬ ErNexus é©—æ¸¬éƒ¨ç½²" },
                "C-GI": { "id": "C-GI", "name": "æˆå“¡C-GI", "skills": ["frontend", "backend", "testing"], "primaryRole": "fullstack", "avatar": "C-GI", "joinDate": "2025-01-01", "notes": "è² è²¬ ErShield é©—æ¸¬éƒ¨ç½²" },
                "C-CI": { "id": "C-CI", "name": "æˆå“¡C-CI", "skills": ["frontend", "backend", "testing"], "primaryRole": "fullstack", "avatar": "C-CI", "joinDate": "2025-01-01", "notes": "è² è²¬ ErTidy é©—æ¸¬éƒ¨ç½²" },
                "C-CS": { "id": "C-CS", "name": "æˆå“¡C-CS", "skills": ["frontend", "backend", "testing"], "primaryRole": "fullstack", "avatar": "C-CS", "joinDate": "2025-01-01", "notes": "å‚™ç”¨æˆå“¡" },
                "C-VC": { "id": "C-VC", "name": "æˆå“¡C-VC", "skills": ["frontend", "backend", "testing"], "primaryRole": "fullstack", "avatar": "C-VC", "joinDate": "2025-01-01", "notes": "å‚™ç”¨æˆå“¡" }
            },
            groups: {
                "groupA": { "id": "groupA", "name": "Açµ„", "description": "Açµ„åœ˜éšŠæˆå“¡", "members": ["A-CC", "A-CA", "A-GI", "A-CI", "A-CS", "A-VC"], "color": "#3b82f6" },
                "groupB": { "id": "groupB", "name": "Bçµ„", "description": "Bçµ„åœ˜éšŠæˆå“¡", "members": ["B-CC", "B-CA", "B-GI", "B-CI", "B-CS", "B-VC"], "color": "#ef4444" },
                "groupC": { "id": "groupC", "name": "Cçµ„", "description": "Cçµ„åœ˜éšŠæˆå“¡", "members": ["C-CC", "C-CA", "C-GI", "C-CI", "C-CS", "C-VC"], "color": "#10b981" }
            },
            roles: {
                "frontend": { "name": "å‰ç«¯é–‹ç™¼", "icon": "[UI]", "color": "#3b82f6", "description": "è² è²¬ç”¨æˆ¶ä»‹é¢è¨­è¨ˆèˆ‡å‰ç«¯åŠŸèƒ½å¯¦ä½œ" },
                "backend": { "name": "å¾Œç«¯é–‹ç™¼", "icon": "[API]", "color": "#ef4444", "description": "è² è²¬ä¼ºæœå™¨é‚è¼¯ã€API é–‹ç™¼èˆ‡è³‡æ–™åº«è¨­è¨ˆ" },
                "testing": { "name": "é©—æ¸¬éƒ¨ç½²", "icon": "[TEST]", "color": "#10b981", "description": "è² è²¬åŠŸèƒ½æ¸¬è©¦ã€å“è³ªä¿è­‰ã€é©—è­‰å ±å‘Šèˆ‡ç³»çµ±éƒ¨ç½²" }
            }
        };

        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `result ${type}`;
            div.innerHTML = `[${new Date().toLocaleTimeString()}] ${message}`;
            document.getElementById('results').appendChild(div);
        }

        function showProjectPreview() {
            const container = document.getElementById('projects-list');
            container.innerHTML = '';

            Object.values(projectsData).forEach(project => {
                const card = document.createElement('div');
                card.className = 'project-card';
                card.innerHTML = `
                    <h3>${project.projectName}</h3>
                    <p><strong>ç‹€æ…‹:</strong> ${project.status === 'active' ? 'é€²è¡Œä¸­' : 'å·²å®Œæˆ'}</p>
                    <p><strong>å„ªå…ˆç´š:</strong> ${project.priority}</p>
                    <p><strong>æè¿°:</strong> ${project.description}</p>
                    <p><strong>æŠ€è¡“æ£§:</strong> ${project.technologies.join(', ')}</p>
                    <p><strong>åœ˜éšŠæˆå“¡:</strong> ${Object.keys(project.team).join(', ')}</p>
                `;
                container.appendChild(card);
            });
        }

        async function initializeGAPI() {
            try {
                document.getElementById('status').textContent = 'æ­£åœ¨åˆå§‹åŒ– Google API...';

                await new Promise((resolve) => {
                    gapi.load('client', resolve);
                });

                await gapi.client.init({
                    discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'],
                });

                tokenClient = google.accounts.oauth2.initTokenClient({
                    client_id: CLIENT_ID,
                    scope: SCOPES,
                    callback: (response) => {
                        if (response.access_token) {
                            accessToken = response.access_token;
                            log('âœ… Google Drive ç™»å…¥æˆåŠŸ', 'success');
                            document.getElementById('buttons').style.display = 'block';
                        }
                    },
                });

                document.getElementById('status').textContent = 'âœ… åˆå§‹åŒ–å®Œæˆï¼Œè«‹é»æ“ŠæŒ‰éˆ•é–‹å§‹ä¸Šå‚³';
                showProjectPreview();

                // è‡ªå‹•ç™»å…¥
                tokenClient.requestAccessToken();

            } catch (error) {
                document.getElementById('status').textContent = 'âŒ åˆå§‹åŒ–å¤±æ•—';
                log(`âŒ åˆå§‹åŒ–éŒ¯èª¤: ${error.message}`, 'error');
            }
        }

        async function uploadFile(fileName, content, description = '') {
            const metadata = {
                name: fileName,
                parents: [FOLDER_ID],
                mimeType: 'application/json',
                description: description
            };

            const form = new FormData();
            form.append('metadata', new Blob([JSON.stringify(metadata)], {type: 'application/json'}));
            form.append('file', new Blob([JSON.stringify(content, null, 2)], {type: 'application/json'}));

            const response = await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${accessToken}`
                },
                body: form
            });

            if (!response.ok) {
                throw new Error(`ä¸Šå‚³å¤±æ•—: ${response.status} ${response.statusText}`);
            }

            return await response.json();
        }

        async function uploadAllProjectData() {
            if (!accessToken) {
                log('âŒ è«‹å…ˆç™»å…¥ Google Drive', 'error');
                return;
            }

            log('ğŸš€ é–‹å§‹ä¸Šå‚³æ‰€æœ‰å°ˆæ¡ˆè³‡æ–™...', 'info');

            try {
                const timestamp = new Date().toISOString().replace(/[:.]/g, '-').split('T');
                const dateStr = timestamp[0];
                const timeStr = timestamp[1].split('-')[0];

                // ä¸Šå‚³æ¯å€‹å°ˆæ¡ˆçš„è©³ç´°è³‡æ–™
                for (const [projectId, projectData] of Object.entries(projectsData)) {
                    const fileName = `ErDashboard_Project_${projectId}_${dateStr}_${timeStr}.json`;
                    const wrappedData = {
                        version: "1.0",
                        type: "project",
                        projectId: projectId,
                        lastSync: new Date().toISOString(),
                        data: projectData
                    };

                    const result = await uploadFile(fileName, wrappedData, `${projectData.projectName} å°ˆæ¡ˆè©³ç´°è³‡æ–™`);
                    log(`âœ… ${projectData.projectName} è³‡æ–™å·²ä¸Šå‚³ (ID: ${result.id})`, 'success');
                }

                // ä¸Šå‚³å°ˆæ¡ˆåˆ†é…è³‡è¨Š
                const assignmentsData = {
                    version: "1.0",
                    type: "assignments",
                    lastSync: new Date().toISOString(),
                    data: {
                        assignments: {
                            ErCore: {
                                projectId: "ErCore",
                                projectName: "ErCore - ä¼æ¥­ç´š AI çµ±ä¸€å¹³å°",
                                members: projectsData.ErCore.team,
                                lastUpdated: dateStr,
                                status: "active"
                            },
                            ErNexus: {
                                projectId: "ErNexus",
                                projectName: "ErNexus - ä¼æ¥­ç´šçµ±ä¸€å¹³å°",
                                members: projectsData.ErNexus.team,
                                lastUpdated: dateStr,
                                status: "completed"
                            },
                            ErShield: {
                                projectId: "ErShield",
                                projectName: "ErShield - å®‰å…¨é˜²è­·å¹³å°",
                                members: projectsData.ErShield.team,
                                lastUpdated: dateStr,
                                status: "active"
                            },
                            ErTidy: {
                                projectId: "ErTidy",
                                projectName: "ErTidy - ä¼æ¥­ç´šæ™ºèƒ½é–‹ç™¼å¹³å°",
                                members: projectsData.ErTidy.team,
                                lastUpdated: dateStr,
                                status: "active"
                            }
                        }
                    }
                };

                const assignmentsResult = await uploadFile(
                    `ErDashboard_Assignments_${dateStr}_${timeStr}.json`,
                    assignmentsData,
                    'å°ˆæ¡ˆåˆ†é…è³‡è¨Š'
                );
                log(`âœ… å°ˆæ¡ˆåˆ†é…è³‡è¨Šå·²ä¸Šå‚³ (ID: ${assignmentsResult.id})`, 'success');

                log('ğŸ‰ æ‰€æœ‰å°ˆæ¡ˆè³‡æ–™ä¸Šå‚³å®Œæˆï¼', 'success');

            } catch (error) {
                log(`âŒ ä¸Šå‚³éç¨‹ä¸­ç™¼ç”ŸéŒ¯èª¤: ${error.message}`, 'error');
            }
        }

        async function uploadCurrentTeamConfig() {
            if (!accessToken) {
                log('âŒ è«‹å…ˆç™»å…¥ Google Drive', 'error');
                return;
            }

            log('ğŸ‘¥ é–‹å§‹ä¸Šå‚³åœ˜éšŠé…ç½®è³‡æ–™...', 'info');

            try {
                const timestamp = new Date().toISOString().replace(/[:.]/g, '-').split('T');
                const dateStr = timestamp[0];
                const timeStr = timestamp[1].split('-')[0];

                // ä¸Šå‚³æˆå“¡è³‡æ–™
                const membersResult = await uploadFile(
                    `ErDashboard_Members_${dateStr}_${timeStr}.json`,
                    {
                        version: "1.0",
                        type: "members",
                        lastSync: new Date().toISOString(),
                        data: teamConfig.members
                    },
                    'åœ˜éšŠæˆå“¡åŸºæœ¬è³‡æ–™'
                );
                log(`âœ… åœ˜éšŠæˆå“¡è³‡æ–™å·²ä¸Šå‚³ (ID: ${membersResult.id})`, 'success');

                // ä¸Šå‚³çµ„ç¹”è³‡æ–™
                const groupsResult = await uploadFile(
                    `ErDashboard_Groups_${dateStr}_${timeStr}.json`,
                    {
                        version: "1.0",
                        type: "groups",
                        lastSync: new Date().toISOString(),
                        data: teamConfig.groups
                    },
                    'åœ˜éšŠçµ„ç¹”çµæ§‹è³‡æ–™'
                );
                log(`âœ… çµ„ç¹”çµæ§‹è³‡æ–™å·²ä¸Šå‚³ (ID: ${groupsResult.id})`, 'success');

                log('ğŸ‰ åœ˜éšŠé…ç½®è³‡æ–™ä¸Šå‚³å®Œæˆï¼', 'success');

            } catch (error) {
                log(`âŒ åœ˜éšŠè³‡æ–™ä¸Šå‚³å¤±æ•—: ${error.message}`, 'error');
            }
        }

        // é é¢è¼‰å…¥å¾Œé–‹å§‹åˆå§‹åŒ–
        window.addEventListener('load', initializeGAPI);
    </script>
</body>
</html>